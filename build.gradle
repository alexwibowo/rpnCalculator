/*
 * This file was generated by the Gradle 'init' task.
 *
 * This is a general purpose Gradle build.
 * Learn how to create Gradle builds at https://guides.gradle.org/creating-new-gradle-builds/
 */

description = "RPN Calculator"

apply plugin: 'java'
apply plugin: 'idea'
apply plugin: 'org.junit.platform.gradle.plugin'
apply plugin: "jacoco"
apply plugin: 'project-report'

sourceCompatibility = 1.8
targetCompatibility = 1.8

buildscript {
	repositories {
		mavenLocal()
		mavenCentral()
	}

	dependencies {
		/** Configure Gradle to run JUnit 5 */
		classpath "org.junit.platform:junit-platform-gradle-plugin:${junitGradlePluginVersion}"
	}

}

sourceSets {
	main {
		java {
			srcDirs = ["src/main/java"]
		}
		resources {
			srcDir 'src/main/resources'
		}
	}
	test {
		java {
			srcDirs = ["src/test/java"]
		}
		resources {
			srcDir 'src/test/resources'
		}

	}
}

repositories {
	mavenLocal()
	mavenCentral()
}

dependencies {
		compile group: 'org.apache.logging.log4j', name: 'log4j-api', version: "${log4j2Version}"
		compile group: 'org.apache.logging.log4j', name: 'log4j-core', version: "${log4j2Version}"

		/* If existing components use Apache Commons Logging 1.x and you want to have this logging routed to Log4j 2, then add the following but do not remove any Commons Logging 1.x dependencies. */
		compile group: 'org.apache.logging.log4j', name: 'log4j-jcl', version: "${log4j2Version}"

	/* If existing components use SLF4J and you want to have this logging routed to Log4j 2, then add the following but do not remove any SLF4J dependencies.
		The Log4j 2 SLF4J Binding allows applications coded to the SLF4J API to use Log4j 2 as the implementation.
		*/
		compile group: 'org.apache.logging.log4j', name: 'log4j-slf4j-impl', version: "${log4j2Version}"

		compile group: 'org.jetbrains', name: 'annotations', version: "${jetbrainsAnnotationsVersion}"
		compile group: 'com.google.guava', name: 'guava', version: "${guavaVersion}"
		compile group: 'org.slf4j', name: 'slf4j-api', version: "${slf4jVersion}"

		compile group: 'com.lmax', name: 'disruptor', version:"${lmaxDisruptorVersion}"

		testCompile "org.mockito:mockito-core:2.18.3"
		testCompile group: 'org.apache.logging.log4j', name: 'log4j-core', version: "${log4j2Version}", classifier: "tests"

		testCompile "org.assertj:assertj-core:${assertjVersion}"
		testCompile "org.junit.jupiter:junit-jupiter-api:${junitJupiterEngineVersion}"
		testCompile "org.junit.jupiter:junit-jupiter-engine:${junitJupiterEngineVersion}"

		// 	The junit-vintage-engine dependency adds support for unit tests that use JUnit 4 or JUnit 3.
		testCompile "org.junit.vintage:junit-vintage-engine:${junitVintageEngineVersion}"

		// The junit-platform-launcher dependency provides a public API for configuring and launching tests. This API is typically used by IDEs and build tools.
		testCompile "org.junit.platform:junit-platform-launcher:${junitPlatformVersion}"

		// The junit-platform-runner dependency allows us to run tests and test suites in a JUnit 4 environment.
		testCompile "org.junit.platform:junit-platform-runner:${junitPlatformVersion}"

}

jacoco {
	toolVersion = '0.8.1'
	applyTo junitPlatformTest

}

jacocoTestReport {
	reports {
		xml.enabled true
		html.enabled true
		csv.enabled true
	}
}


plugins.withType(JavaPlugin) {
	task testJar(type: Jar) {
		classifier "test"
		from sourceSets.test.output
	}

	/** Produces sources JAR */
	task sourcesJar(type: Jar, dependsOn: classes) {
		classifier = 'sources'
		from sourceSets.main.allSource
	}

	/** Produces javadoc JAR */
	task javadocJar(type: Jar, dependsOn: javadoc) {
		classifier = 'javadoc'
		from javadoc.destinationDir
	}

	artifacts {
		archives sourcesJar
		archives javadocJar
	}
}
